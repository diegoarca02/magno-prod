<div id="kt_header" style="background-color: #f4f7f9;" class="header align-items-stretch">
    <!--begin::Container-->
    <div class="container-fluid d-flex align-items-stretch justify-content-between">
        <!--begin::Aside mobile toggle-->
        <div class="d-flex align-items-center d-lg-none ms-n2 me-2" title="Show aside menu">
            <div class="btn btn-icon btn-active-light-primary w-30px h-30px w-md-40px h-md-40px cursor-pointer" (click)="open_menu()">
                <!--begin::Svg Icon | path: icons/duotune/abstract/abs015.svg-->
                <span class="svg-icon svg-icon-1">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                        <path d="M21 7H3C2.4 7 2 6.6 2 6V4C2 3.4 2.4 3 3 3H21C21.6 3 22 3.4 22 4V6C22 6.6 21.6 7 21 7Z" fill="black" />
                        <path opacity="0.3" d="M21 14H3C2.4 14 2 13.6 2 13V11C2 10.4 2.4 10 3 10H21C21.6 10 22 10.4 22 11V13C22 13.6 21.6 14 21 14ZM22 20V18C22 17.4 21.6 17 21 17H3C2.4 17 2 17.4 2 18V20C2 20.6 2.4 21 3 21H21C21.6 21 22 20.6 22 20Z" fill="black" />
                    </svg>
                </span>
                <!--end::Svg Icon-->
            </div>
        </div>
        <!--end::Aside mobile toggle-->
        <!--begin::Mobile logo-->
        <div class="d-flex align-items-center flex-grow-1 flex-lg-grow-0">
            
        </div>
        <!--end::Mobile logo-->
        <!--begin::Wrapper-->
        <div class="d-flex align-items-stretch justify-content-between flex-lg-grow-1">
            <!--begin::Navbar-->
            <div class="d-flex align-items-stretch" id="kt_header_nav">
                
                <div class="d-flex align-items-center" id="kt_header_user_menu_toggle">
                    <!--begin::Menu wrapper-->

                    <!--begin::User-->
                    <div class="d-flex align-items-center">
                        <!--begin::Menu wrapper-->
                        <a *ngIf="cliente_atendido != undefined" class="d-flex cursor-pointer" style="background: #11171e;padding: 5px 10px;
                        border-radius: 5px;">
                            <div class="d-flex align-items-center">
                                <div class="cursor-pointer symbol symbol-30px symbol-md-30px me-2">
                                    <span class="svg-icon svg-icon-muted svg-icon-2x"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M6.28548 15.0861C7.34369 13.1814 9.35142 12 11.5304 12H12.4696C14.6486 12 16.6563 13.1814 17.7145 15.0861L19.3493 18.0287C20.0899 19.3618 19.1259 21 17.601 21H6.39903C4.87406 21 3.91012 19.3618 4.65071 18.0287L6.28548 15.0861Z" fill="currentColor"/>
                                        <rect opacity="0.3" x="8" y="3" width="8" height="8" rx="4" fill="currentColor"/>
                                        </svg>
                                    </span>
                                </div>
                            </div>
                            <div class="d-flex flex-column" style="margin-right: 1rem;">
                                <div class="fw-bold d-flex align-items-center fs-5 text-end text-white fw-600">
                                    <span style="font-size: 0.9rem !important;" class="text-yellow">
                                        {{cliente_atendido.nombres.split(' ')[0]}}  
                                        {{cliente_atendido.apellidos.split(' ')[0]}}   
                                    </span>
                                </div>

                                <small class="text-muted" style="font-size: .7em !important;">Cliente atendido</small>
                            
                            </div>

                            <button class="btn btn-icon btn-sm btn-danger w-25px h-25px" style="margin-top: 3px;" (click)="remove_cliente_selected()">
                                <span class="svg-icon svg-icon-muted svg-icon-3"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <rect opacity="0.5" x="6" y="17.3137" width="16" height="2" rx="1" transform="rotate(-45 6 17.3137)" fill="currentColor"/>
                                    <rect x="7.41422" y="6" width="16" height="2" rx="1" transform="rotate(45 7.41422 6)" fill="currentColor"/>
                                    </svg>
                                    
                                </span>
                            </button>
                            
                        </a>

                        
                        
                    </div>
                    <!--end::Toolbar wrapper-->

                    <a class="d-flex cursor-pointer" *ngIf="cliente_atendido == undefined" style="background: #11171e;padding: 5px 10px;
                    border-radius: 5px;" data-bs-toggle="modal" [attr.data-bs-target]="'#addClienteAtencion'" (click)="remove_cliente_selected()">
                        <div class="d-flex align-items-center">
                            <div class="cursor-pointer symbol symbol-30px symbol-md-30px me-2">
                                <span class="svg-icon svg-icon-muted svg-icon-2x"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M6.28548 15.0861C7.34369 13.1814 9.35142 12 11.5304 12H12.4696C14.6486 12 16.6563 13.1814 17.7145 15.0861L19.3493 18.0287C20.0899 19.3618 19.1259 21 17.601 21H6.39903C4.87406 21 3.91012 19.3618 4.65071 18.0287L6.28548 15.0861Z" fill="currentColor"/>
                                    <rect opacity="0.3" x="8" y="3" width="8" height="8" rx="4" fill="currentColor"/>
                                    </svg>
                                </span>
                            </div>
                        </div>
                        <div class="d-flex flex-column">
                            <div class="fw-bold d-flex align-items-center fs-7 text-end text-white">
                                <span style="font-size: 0.9rem !important;">
                                    Seleccionar 
                                </span>        
                            </div>
                            <small class="text-muted" style="font-size: .7em !important;">Cliente atendido</small>
                        </div>
                        
                    </a>

                    
                </div>
            </div>
            <!--end::Navbar-->
            <!--begin::Topbar-->
            <div class="d-flex align-items-stretch flex-shrink-0">
                <!--begin::Toolbar wrapper-->
                <div class="d-flex align-items-stretch flex-shrink-0">
                    <div class="d-flex align-items-center ms-1 ms-lg-3 me-3">
                        <!--begin::Drawer toggle-->
                        <div class="btn btn-icon btn-custom btn-icon-muted btn-secondary w-35px h-35px position-relative" data-kt-menu-trigger="{default: 'click', lg: 'hover'}" data-kt-menu-attach="parent" data-kt-menu-placement="bottom-end" id="kt_menu_item_wow">
                            <span class="svg-icon svg-icon-muted svg-icon-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path opacity="0.3" d="M12 22C13.6569 22 15 20.6569 15 19C15 17.3431 13.6569 16 12 16C10.3431 16 9 17.3431 9 19C9 20.6569 10.3431 22 12 22Z" fill="currentColor"/>
                                <path d="M19 15V18C19 18.6 18.6 19 18 19H6C5.4 19 5 18.6 5 18V15C6.1 15 7 14.1 7 13V10C7 7.6 8.7 5.6 11 5.1V3C11 2.4 11.4 2 12 2C12.6 2 13 2.4 13 3V5.1C15.3 5.6 17 7.6 17 10V13C17 14.1 17.9 15 19 15ZM11 10C11 9.4 11.4 9 12 9C12.6 9 13 8.6 13 8C13 7.4 12.6 7 12 7C10.3 7 9 8.3 9 10C9 10.6 9.4 11 10 11C10.6 11 11 10.6 11 10Z" fill="currentColor"/>
                                </svg>
                            </span>
                            <span *ngIf="ntareas >= 1" class="bullet bullet-dot bg-success h-6px w-6px position-absolute translate-middle top-0 start-50 animation-blink">
                            </span>
                        </div>
                        <!--end::Drawer toggle-->

                        <div class="menu menu-sub menu-sub-dropdown menu-column w-350px w-lg-375px" data-kt-menu="true" id="kt_menu_notifications" style="">
                            <!--begin::Heading-->
                            <div class="d-flex flex-column bgi-no-repeat rounded-top" style="background: #191c33 !important;">
                                <!--begin::Title-->                                   
                                <h3 class="text-white fw-semibold px-9 mt-10 mb-6">
                                    Notificaciones {{ntareas}}
                                    <a [routerLink]="['/tasks']" class="fs-8 opacity-75 ps-3" > 
                                        Ver todas
                                    </a>
                                </h3>
                                <!--end::Title-->
                            </div>
                            <!--end::Heading-->
                            
                            <!--begin::Tab content-->
                            <div class="tab-content">
                                <!--begin::Tab panel-->
                                <div class="tab-pane fade active show" id="kt_topbar_notifications_1" role="tabpanel">
                                    <!--begin::Items-->
                                    <div class="scroll-y mh-325px my-5 px-8" *ngIf="tareas.length >= 1">
                                        <ng-container *ngFor="let item of tareas; let lst = last">
                                            <!--begin::Item-->
                                            <div class="d-flex flex-stack py-4">
                                                <!--begin::Section-->
                                                <div class="d-flex align-items-center">
                                            
                                                    <!--begin::Title-->
                                                    <div class="mb-0 me-2">
                                                        <a class="fs-6 text-gray-800 text-hover-primary fw-bold">Tarea</a>
                                                        <div>
                                                            <span>{{item.descripcion}}</span>
                                                        </div>
                                                    </div>
                                                    <!--end::Title-->
                                                </div>
                                                <!--end::Section-->
                        
                                                <!--begin::Label-->
                                                <span class="text-muted fs-8">
                                                    {{item.date_realizar|date}}
                                                    <br>
                                                    {{item.date_realizar|date:'hh:mm a'}}
                                                </span>
                                                <!--end::Label-->
                                            </div>
                                            <!--begin::Item-->
                                            <div class="separator separator-dashed my-0" *ngIf="!lst"></div>
                                        </ng-container>
                                    </div>
                                    <!--end::Items-->

                                    <div class="text-center pt-5 pb-5" *ngIf="tareas.length == 0">
                                        <span class="text-muted">No hay tareas pendientes</span> 
                                    </div>
                                </div>
                                <!--end::Tab panel-->      
                            </div>
                            <!--end::Tab content-->
                        </div>
                    </div>
                    <!--begin::User-->
                    <div class="d-flex align-items-center ms-1 ms-lg-3" id="kt_header_user_menu_toggle">
                        <!--begin::Menu wrapper-->
                        <a class="d-flex" (click)="changeNav()">
                            <div class="cursor-pointer symbol symbol-35px">
                                <img class="rounded-3" *ngIf="!user.avatar" src="assets/media/avatars/150-26.jpg" alt="user" />
                                <img class="rounded-3" *ngIf="user.avatar" [src]="user.avatar" alt="user" />
                            </div>
                        </a>

                        <!--begin::Menu-->
                        <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg menu-state-primary fw-bold py-4 fs-6 w-275px" [ngClass]="{'show': show_nav}" style="z-index: 105; position: fixed; inset: 0px 0px auto auto; margin: 0px; transform: translate(-30px, 65px);">
                            <!--begin::Menu item-->
                            <div class="menu-item px-3">
                                <div class="menu-content d-flex align-items-center px-3">
                                    <!--begin::Avatar-->
                                    <div class="symbol symbol-50px me-5">
                                        <img class="rounded-3" *ngIf="!user.avatar" src="assets/media/avatars/150-26.jpg" alt="user" />
                                        <img class="rounded-3" *ngIf="user.avatar" [src]="user.avatar" alt="user" />
                                    </div>
                                    <!--end::Avatar-->
                                    <!--begin::Username-->
                                    <div class="d-flex flex-column">
                                        <div class="fw-bolder d-flex align-items-center fs-5">
                                            {{user.nombres.split(' ')[0]}}  {{user.apellidos.split(' ')[0]}}
                                        </div>
                                        <a class="fw-bold text-muted fs-7">
                                            {{user.email}}
                                        </a>
                                    </div>
                                    <!--end::Username-->
                                </div>
                            </div>
                            <!--end::Menu item-->
                            <!--begin::Menu separator-->
                            <div class="separator my-2"></div>
                            <!--end::Menu separator-->
                            <!--begin::Menu item-->
                            <div class="menu-item px-5">
                                <a [routerLink]="['/profile']" class="menu-link px-5">
                                    <i class="bi bi-person me-3"></i>
                                    Mi perfíl
                                </a>
                            </div>
                            <div class="menu-item px-5">
                                <a [routerLink]="['/tasks']" class="menu-link px-5">
                                    <i class="bi bi-list-task me-3"></i>
                                    Tareas
                                </a>
                            </div>
                            <!--end::Menu item-->
                            
                            <!--begin::Menu separator-->
                            <div class="separator my-2"></div>
                            <!--end::Menu separator-->
                           
                            <!--begin::Menu item-->
                            <div class="menu-item px-5 my-1">
                                <a href="../../demo1/dist/account/settings.html" class="menu-link px-5">Account Settings</a>
                            </div>
                            <!--end::Menu item-->
                            <!--begin::Menu item-->
                            <div class="menu-item px-5">
                                <a (click)="logout()" class="menu-link px-5 cursor-pointer">
                                    <span class="svg-icon svg-icon-muted svg-icon-3 me-2"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect opacity="0.3" x="8.5" y="11" width="12" height="2" rx="1" fill="currentColor"/>
                                        <path d="M10.3687 11.6927L12.1244 10.2297C12.5946 9.83785 12.6268 9.12683 12.194 8.69401C11.8043 8.3043 11.1784 8.28591 10.7664 8.65206L7.84084 11.2526C7.39332 11.6504 7.39332 12.3496 7.84084 12.7474L10.7664 15.3479C11.1784 15.7141 11.8043 15.6957 12.194 15.306C12.6268 14.8732 12.5946 14.1621 12.1244 13.7703L10.3687 12.3073C10.1768 12.1474 10.1768 11.8526 10.3687 11.6927Z" fill="currentColor"/>
                                        <path opacity="0.5" d="M16 5V6C16 6.55228 15.5523 7 15 7C14.4477 7 14 6.55228 14 6C14 5.44772 13.5523 5 13 5H6C5.44771 5 5 5.44772 5 6V18C5 18.5523 5.44771 19 6 19H13C13.5523 19 14 18.5523 14 18C14 17.4477 14.4477 17 15 17C15.5523 17 16 17.4477 16 18V19C16 20.1046 15.1046 21 14 21H5C3.89543 21 3 20.1046 3 19V5C3 3.89543 3.89543 3 5 3H14C15.1046 3 16 3.89543 16 5Z" fill="currentColor"/>
                                        </svg>
                                    </span>
                                    Cerrar sesión
                                </a>
                            </div>
                            
                        </div>
                        <!--end::Menu-->
                        
                    </div>
                <!--end::Toolbar wrapper-->
                </div>
            <!--end::Topbar-->
            </div>
        <!--end::Wrapper-->
        </div>
    <!--end::Container-->
    </div>
</div>

<div class="modal fade" id="addClienteAtencion" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title fw-700">Cliente atendido</h3>
                <div class="btn btn-icon btn-sm btn-active-light-primary ms-2" data-bs-dismiss="modal" aria-label="Close">
                    <!--begin::Svg Icon | path: /var/www/preview.keenthemes.com/kt-products/metronic/releases/2022-07-14-092914/core/html/src/media/icons/duotune/arrows/arr088.svg-->
                    <span class="svg-icon svg-icon-muted svg-icon-2hx"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect opacity="0.5" x="7.05025" y="15.5356" width="12" height="2" rx="1" transform="rotate(-45 7.05025 15.5356)" fill="currentColor"/>
                        <rect x="8.46447" y="7.05029" width="12" height="2" rx="1" transform="rotate(45 8.46447 7.05029)" fill="currentColor"/>
                        </svg>
                    </span>
                        <!--end::Svg Icon-->
                </div>
            </div>
            <div class="modal-body pb-0">
                <div class="input-group">
                    <input type="text" (keyup.ENTER)="init_clientes()" class="form-control" placeholder="Buscar cliente" name="filtro_cliente" [(ngModel)]="filtro_cliente">
                    <button class="btn btn-dark" (click)="init_clientes()">
                        <span class="svg-icon icon-size-2qx" style="margin-right: 0px !important"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect opacity="0.5" x="17.0365" y="15.1223" width="8.15546" height="2" rx="1" transform="rotate(45 17.0365 15.1223)" fill="currentColor"/>
                            <path d="M11 19C6.55556 19 3 15.4444 3 11C3 6.55556 6.55556 3 11 3C15.4444 3 19 6.55556 19 11C19 15.4444 15.4444 19 11 19ZM11 5C7.53333 5 5 7.53333 5 11C5 14.4667 7.53333 17 11 17C14.4667 17 17 14.4667 17 11C17 7.53333 14.4667 5 11 5Z" fill="currentColor"/>
                            </svg>
                        </span>
                    </button>
                </div>
            </div>
            <div class="modal-body justify-content-center" style="min-height:550px;max-height:550px;overflow: hidden;overflow-y: auto;">
                <ng-container *ngIf="!load_clientes">
                    <div class="table-responsive"  *ngIf="clientes_nuevos.length >= 1">
                        <!--begin::Table-->
                        <table class="table table-row-dashed align-middle gs-0 gy-3 my-0">
                            <tbody>
                                <tr *ngFor="let item of clientes_nuevos" style="cursor: pointer;">
                                    <td>
                                        <div class="d-flex justify-content-between">
                                            <div class="d-flex align-items-center">
                                                <div class="symbol symbol-45px me-5">
                                                    <span class="symbol-label fw-bold" [ngClass]="{
                                                        'bg-light-danger text-danger': item.cliente.nombres.charAt(0) >='A' && item.cliente.nombres.charAt(0) <= 'H',
                                                        'bg-light-primary text-primary': item.cliente.nombres.charAt(0) >='I' && item.cliente.nombres.charAt(0) <= 'O',
                                                        'bg-light-info text-info': item.cliente.nombres.charAt(0) >='P' && item.cliente.nombres.charAt(0) <= 'U',
                                                        'bg-light-success text-success': item.cliente.nombres.charAt(0) >='V' && item.cliente.nombres.charAt(0) <= 'Z'}">
                                                        {{item.cliente.nombres.charAt(0)}}
                                                    </span>
                                                </div>
                                                <div class="d-flex justify-content-start flex-column">
                                                    <a class="text-gray-800 fw-600 text-hover-primary fs-6">{{item.cliente.nombres.split(' ')[0]}} {{item.cliente.apellidos.split(' ')[0]}}</a>
                                                    <span class="text-gray-400 fw-semibold d-block fs-7">
                                                        {{item.cliente.email}}
                                                    </span>
                                                </div>
                                            </div>
                                            <div class="d-flex">
                                                <a (click)="redirect_url('/clientes/'+item.cliente._id,'#addClienteAtencion')" class="btn btn-sm btn-icon me-2 btn-bg-light btn-active-color-primary w-30px h-30px">
                                                    <span class="svg-icon svg-icon-muted svg-icon-3"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                        <path d="M6.28548 15.0861C7.34369 13.1814 9.35142 12 11.5304 12H12.4696C14.6486 12 16.6563 13.1814 17.7145 15.0861L19.3493 18.0287C20.0899 19.3618 19.1259 21 17.601 21H6.39903C4.87406 21 3.91012 19.3618 4.65071 18.0287L6.28548 15.0861Z" fill="currentColor"/>
                                                        <rect opacity="0.3" x="8" y="3" width="8" height="8" rx="4" fill="currentColor"/>
                                                        </svg>
                                                    </span>
                                                </a>
                                                <button (click)="select_cliente(item.cliente)" class="btn btn-sm btn-icon btn-bg-light btn-active-color-primary w-30px h-30px">
                                                    <span class="svg-icon svg-icon-muted svg-icon-3" >
                                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                            <path opacity="0.3" d="M10 18C9.7 18 9.5 17.9 9.3 17.7L2.3 10.7C1.9 10.3 1.9 9.7 2.3 9.3C2.7 8.9 3.29999 8.9 3.69999 9.3L10.7 16.3C11.1 16.7 11.1 17.3 10.7 17.7C10.5 17.9 10.3 18 10 18Z" fill="currentColor"/>
                                                            <path d="M10 18C9.7 18 9.5 17.9 9.3 17.7C8.9 17.3 8.9 16.7 9.3 16.3L20.3 5.3C20.7 4.9 21.3 4.9 21.7 5.3C22.1 5.7 22.1 6.30002 21.7 6.70002L10.7 17.7C10.5 17.9 10.3 18 10 18Z" fill="currentColor"/>
                                                        </svg>
                                                    </span>
                                                </button>
                                            </div>
                                        </div>
                                        
                                    </td>
                                </tr>
                            </tbody>
                            <!--end::Table body-->
                        </table>
                        <!--end::Table-->
                    </div>
                    <div class="" *ngIf="clientes_nuevos.length == 0">
                        <div class="text-center" style="margin-top: 2rem !important;height: 100% !important;" >
                            <a style="font-weight: 700;
                                font-size: 2rem;" class="app-sidebar-logo-default text-dark">
                                    <span class="text-yellow">OO</span>neunion
                            </a>
                            <div class="font-size-h4 mb-8 text-muted">No se pudieron encontrar cliente con los datos ingresados.</div>
                            <a class="btn btn-dark btn-sm" (click)="redirect_url('/clientes/create','#addClienteAtencion')" >
                                <i class="bi bi-person"></i>
                                Nuevo Cliente
                            </a>
                        </div>
                    </div>
                    
                </ng-container>
                <ng-container *ngIf="load_clientes">
                    <div class="py-20 text-center">
                        <div class="spinner-border" style="width: 3rem; height: 3rem;" role="status">
                            <span class="sr-only">Loading...</span>
                        </div>
                    </div>
                </ng-container>
            </div>
            
            
        </div>
    </div>
</div> 