<div class="d-flex flex-column flex-root">
    <!--begin::Page-->
    <div class="page d-flex flex-row flex-column-fluid">
        <!--begin::Aside-->
        <app-side-bar class="no-print"></app-side-bar>
        <!--end::Aside-->
        <!--begin::Wrapper-->
        <div class="wrapper d-flex flex-column flex-row-fluid" id="kt_wrapper">
            <!--begin::Header-->
            <app-top-bar class="no-print"></app-top-bar>
            <!--end::Header-->
            <!--begin::Content-->
            <div class="content d-flex flex-column flex-column-fluid" id="kt_content">
                <!--begin::Toolbar-->
                <div class="toolbar no-print" id="kt_toolbar" >
                    <!--begin::Container-->
                    <div id="kt_toolbar_container" class="container-fluid d-flex flex-stack">
                        <!--begin::Page title-->
                        <div data-kt-swapper="true" data-kt-swapper-mode="prepend" data-kt-swapper-parent="{default: '#kt_content_container', 'lg': '#kt_toolbar_container'}" class="page-title d-flex align-items-center flex-wrap me-3 mb-5 mb-lg-0">
                            <!--begin::Title-->
                            <h1 class="d-flex align-items-center text-dark fw-bolder fs-3 my-1">Manufactura
                                <!--begin::Separator-->
                                <span class="h-20px border-gray-200 border-start mx-5"></span>
                                <!--end::Separator-->
                                <!--begin::Description-->
                                <ol class="breadcrumb text-muted fs-6 fw-semibold">
                                    <li class="breadcrumb-item pe-3">
                                        <a [routerLink]="['/ingresos']"  class="pe-3">
                                            Ingresos
                                        </a>
                                    </li>
                                    <li class="breadcrumb-item pe-3">Detalle de ingreso</li>
                                    
                                </ol>
                      
                                <!--end::Description--></h1>
                            <!--end::Title-->
                        </div>
                        <!--end::Page title-->
                        <!--begin::Actions-->
                        <div class="d-flex align-items-center py-1">
                            <h3 class="card-title align-items-start flex-column">
                                <span class="text-muted fw-bold fs-7">Panel Administrador</span>
                            </h3>
                        </div>
                        <!--end::Actions-->
                    </div>
                    <!--end::Container-->
                </div>
                <!--end::Toolbar-->
                <!--begin::Post-->
                <div class="post d-flex flex-column-fluid" id="kt_post">
                    <!--begin::Container-->
                    <div id="kt_content_container" class="container-xxl">
                        <!--begin::Row-->
                        <div class="row gy-5 g-xl-8">
                            <div class="col-12">
                                <ng-container *ngIf="!load_data">
                                    <ng-container *ngIf="data">
                                        <div class="card mb-5 mb-xl-10">
                                            <!--begin::Body-->
                                            <div class="card-header border-0 pt-5">
                                                <h3 class="card-title align-items-start flex-column fw-700">
                                                    <span *ngIf="ingreso.pedido" class="card-label fw-bold fs-3 mb-1 fw-700">
                                                        Ingreso proveedor #PE{{ingreso.pedido.year}}-{{ingreso.pedido.serie.toString().padStart(6,'000000')}}
                                                    </span>
                                                    <span *ngIf="!ingreso.pedido" class="card-label fw-bold fs-3 mb-1 fw-700">
                                                        Ingreso manual #{{ingreso._id}}
                                                    </span>
                                                    <span class="text-muted mt-1 fw-semibold fs-7 d-none d-sm-block">Lorem ipsum dolor sit amet consectetur adipisicing elit.</span>
                                                </h3>
                                                <div class="card-toolbar">
                                                   <!--  <button class="btn btn-dark fw-bold"></button> -->
                                                </div>
                                            </div>
                                            <div class="card-body py-10">
                                                <!--end::Stats-->
                                                <div class=" d-none d-sm-block">
                                                    <div class="row">
                                                        <div class="col">
                                                            <div class="d-flex align-items-center me-5 me-xl-13">
                                                                <!--begin::Symbol-->
                                                                <div class="symbol symbol-30px symbol-circle me-3">
                                                                    <span class="symbol-label bg-primary text-inverse-primary fw-bold">
                                                                        {{ingreso.colaborador.nombres.charAt(0)}}
                                                                    </span>
                                                                </div>
                                                                <!--end::Symbol-->
                                                                <!--begin::Info-->
                                                                <div class="m-0">
                                                                    <span class="fw-semibold text-gray-400 d-block fs-8">Colaborador</span>
                                                                    <a class="fw-bold text-gray-800 text-hover-primary fs-7">
                                                                        {{ingreso.colaborador.nombres.split(' ')[0]}} {{ingreso.colaborador.apellidos.split(' ')[0]}}
                                                                    </a>
                                                                </div>
                                                                <!--end::Info-->
                                                            </div>
                                                        </div>
                                                        <div class="col">
                                                            <div class="d-flex align-items-center me-5 me-xl-13">
                                                                <!--begin::Symbol-->
                                                                <div class="symbol symbol-30px symbol-circle me-3">
                                                                    <span class="symbol-label bg-primary fw-bold">
                                                                        <span class="svg-icon svg-icon-5 svg-icon-white">
                                                                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                            <path opacity="0.3" d="M3 13H10C10.6 13 11 13.4 11 14V21C11 21.6 10.6 22 10 22H3C2.4 22 2 21.6 2 21V14C2 13.4 2.4 13 3 13Z" fill="currentColor"/>
                                                                            <path d="M7 16H6C5.4 16 5 15.6 5 15V13H8V15C8 15.6 7.6 16 7 16Z" fill="currentColor"/>
                                                                            <path opacity="0.3" d="M14 13H21C21.6 13 22 13.4 22 14V21C22 21.6 21.6 22 21 22H14C13.4 22 13 21.6 13 21V14C13 13.4 13.4 13 14 13Z" fill="currentColor"/>
                                                                            <path d="M18 16H17C16.4 16 16 15.6 16 15V13H19V15C19 15.6 18.6 16 18 16Z" fill="currentColor"/>
                                                                            <path opacity="0.3" d="M3 2H10C10.6 2 11 2.4 11 3V10C11 10.6 10.6 11 10 11H3C2.4 11 2 10.6 2 10V3C2 2.4 2.4 2 3 2Z" fill="currentColor"/>
                                                                            <path d="M7 5H6C5.4 5 5 4.6 5 4V2H8V4C8 4.6 7.6 5 7 5Z" fill="currentColor"/>
                                                                            <path opacity="0.3" d="M14 2H21C21.6 2 22 2.4 22 3V10C22 10.6 21.6 11 21 11H14C13.4 11 13 10.6 13 10V3C13 2.4 13.4 2 14 2Z" fill="currentColor"/>
                                                                            <path d="M18 5H17C16.4 5 16 4.6 16 4V2H19V4C19 4.6 18.6 5 18 5Z" fill="currentColor"/>
                                                                            </svg>
                                                                            </span>
                                                                    </span>
                                                                </div>
                                                                <!--end::Symbol-->
                                                                <!--begin::Info-->
                                                                <div class="m-0">
                                                                    <span class="fw-semibold text-gray-400 d-block fs-8">Almacen</span>
                                                                    <a class="fw-bold text-gray-800 text-hover-primary fs-7">
                                                                        {{ingreso.almacen}}
                                                                    </a>
                                                                </div>
                                                                <!--end::Info-->
                                                            </div>
                                                        </div>
                                                        <div class="col">
                                                            <div class="d-flex align-items-center me-5 me-xl-13">
                                                                <!--begin::Symbol-->
                                                                <div class="symbol symbol-30px symbol-circle me-3">
                                                                    <span class="symbol-label bg-primary fw-bold">
                                                                      
                                                                        <span class="svg-icon svg-icon-5 svg-icon-white"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                            <path opacity="0.3" d="M18 21.6C16.3 21.6 15 20.3 15 18.6V2.50001C15 2.20001 14.6 1.99996 14.3 2.19996L13 3.59999L11.7 2.3C11.3 1.9 10.7 1.9 10.3 2.3L9 3.59999L7.70001 2.3C7.30001 1.9 6.69999 1.9 6.29999 2.3L5 3.59999L3.70001 2.3C3.50001 2.1 3 2.20001 3 3.50001V18.6C3 20.3 4.3 21.6 6 21.6H18Z" fill="currentColor"/>
                                                                            <path d="M12 12.6H11C10.4 12.6 10 12.2 10 11.6C10 11 10.4 10.6 11 10.6H12C12.6 10.6 13 11 13 11.6C13 12.2 12.6 12.6 12 12.6ZM9 11.6C9 11 8.6 10.6 8 10.6H6C5.4 10.6 5 11 5 11.6C5 12.2 5.4 12.6 6 12.6H8C8.6 12.6 9 12.2 9 11.6ZM9 7.59998C9 6.99998 8.6 6.59998 8 6.59998H6C5.4 6.59998 5 6.99998 5 7.59998C5 8.19998 5.4 8.59998 6 8.59998H8C8.6 8.59998 9 8.19998 9 7.59998ZM13 7.59998C13 6.99998 12.6 6.59998 12 6.59998H11C10.4 6.59998 10 6.99998 10 7.59998C10 8.19998 10.4 8.59998 11 8.59998H12C12.6 8.59998 13 8.19998 13 7.59998ZM13 15.6C13 15 12.6 14.6 12 14.6H10C9.4 14.6 9 15 9 15.6C9 16.2 9.4 16.6 10 16.6H12C12.6 16.6 13 16.2 13 15.6Z" fill="currentColor"/>
                                                                            <path d="M15 18.6C15 20.3 16.3 21.6 18 21.6C19.7 21.6 21 20.3 21 18.6V12.5C21 12.2 20.6 12 20.3 12.2L19 13.6L17.7 12.3C17.3 11.9 16.7 11.9 16.3 12.3L15 13.6V18.6Z" fill="currentColor"/>
                                                                            </svg>
                                                                        </span>
                                                                    </span>
                                                                </div>
                                                                <!--end::Symbol-->
                                                                <!--begin::Info-->
                                                                <div class="m-0">
                                                                    <ng-container *ngIf="ingreso.pedido">
                                                                        <span class="fw-semibold text-gray-400 d-block fs-8">Proveedor</span>
                                                                        <a class="fw-bold text-gray-800 text-hover-primary fs-7">
                                                                            {{pedido.pedido.proveedor.razon_social}}
                                                                        </a>
                                                                    </ng-container>
                                                                    <ng-container *ngIf="!ingreso.pedido">
                                                                        <span class="fw-semibold text-gray-400 d-block fs-8">Proveedor</span>
                                                                        <a class="fw-bold text-gray-800 text-hover-primary fs-7">
                                                                            Ingreso manual
                                                                        </a>
                                                                    </ng-container>
                                                                </div>
                                                                <!--end::Info-->
                                                            </div>
                                                        </div>
                                                        <div class="col">
                                                            <div class="d-flex align-items-center me-5 me-xl-13">
                                                                <!--begin::Symbol-->
                                                                <div class="symbol symbol-30px symbol-circle me-3">
                                                                    <span class="symbol-label bg-success fw-bold">
                                                                      
                                                                        <span class="svg-icon svg-icon-5 svg-icon-white"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                            <path opacity="0.3" d="M3 6C2.4 6 2 5.6 2 5V3C2 2.4 2.4 2 3 2H5C5.6 2 6 2.4 6 3C6 3.6 5.6 4 5 4H4V5C4 5.6 3.6 6 3 6ZM22 5V3C22 2.4 21.6 2 21 2H19C18.4 2 18 2.4 18 3C18 3.6 18.4 4 19 4H20V5C20 5.6 20.4 6 21 6C21.6 6 22 5.6 22 5ZM6 21C6 20.4 5.6 20 5 20H4V19C4 18.4 3.6 18 3 18C2.4 18 2 18.4 2 19V21C2 21.6 2.4 22 3 22H5C5.6 22 6 21.6 6 21ZM22 21V19C22 18.4 21.6 18 21 18C20.4 18 20 18.4 20 19V20H19C18.4 20 18 20.4 18 21C18 21.6 18.4 22 19 22H21C21.6 22 22 21.6 22 21Z" fill="currentColor"/>
                                                                            <path d="M3 16C2.4 16 2 15.6 2 15V9C2 8.4 2.4 8 3 8C3.6 8 4 8.4 4 9V15C4 15.6 3.6 16 3 16ZM13 15V9C13 8.4 12.6 8 12 8C11.4 8 11 8.4 11 9V15C11 15.6 11.4 16 12 16C12.6 16 13 15.6 13 15ZM17 15V9C17 8.4 16.6 8 16 8C15.4 8 15 8.4 15 9V15C15 15.6 15.4 16 16 16C16.6 16 17 15.6 17 15ZM9 15V9C9 8.4 8.6 8 8 8H7C6.4 8 6 8.4 6 9V15C6 15.6 6.4 16 7 16H8C8.6 16 9 15.6 9 15ZM22 15V9C22 8.4 21.6 8 21 8H20C19.4 8 19 8.4 19 9V15C19 15.6 19.4 16 20 16H21C21.6 16 22 15.6 22 15Z" fill="currentColor"/>
                                                                            </svg>
                                                                        </span>
                                                                    </span>
                                                                </div>
                                                                <!--end::Symbol-->
                                                                <!--begin::Info-->
                                                                <div class="m-0">
                                                                    <ng-container *ngIf="ingreso.pedido">
                                                                        <span class="fw-semibold text-gray-400 d-block fs-8">Cant. solicitada</span>
                                                                        <a class="fw-bold text-gray-800 text-hover-primary fs-7">
                                                                            {{pedido.cantidad.toFixed(2)}}
                                                                            <small>{{pedido.unidad}}</small>
                                                                        </a>
                                                                    </ng-container>
                                                                    <ng-container *ngIf="!ingreso.pedido">
                                                                        <span class="fw-semibold text-gray-400 d-block fs-8">Cant. solicitada</span>
                                                                        <a class="fw-bold text-gray-800 text-hover-primary fs-7">
                                                                            ---
                                                                            <small>{{ingreso.unidad}}</small>
                                                                        </a>
                                                                    </ng-container>
                                                                </div>
                                                                <!--end::Info-->
                                                            </div>
                                                        </div>
                                                        <div class="col">
                                                            <div class="d-flex align-items-center me-5 me-xl-13">
                                                                <!--begin::Symbol-->
                                                                <div class="symbol symbol-30px symbol-circle me-3">
                                                                    <span class="symbol-label bg-success fw-bold">
                                                                      
                                                                        <span class="svg-icon svg-icon-5 svg-icon-white"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                            <path opacity="0.3" d="M3 6C2.4 6 2 5.6 2 5V3C2 2.4 2.4 2 3 2H5C5.6 2 6 2.4 6 3C6 3.6 5.6 4 5 4H4V5C4 5.6 3.6 6 3 6ZM22 5V3C22 2.4 21.6 2 21 2H19C18.4 2 18 2.4 18 3C18 3.6 18.4 4 19 4H20V5C20 5.6 20.4 6 21 6C21.6 6 22 5.6 22 5ZM6 21C6 20.4 5.6 20 5 20H4V19C4 18.4 3.6 18 3 18C2.4 18 2 18.4 2 19V21C2 21.6 2.4 22 3 22H5C5.6 22 6 21.6 6 21ZM22 21V19C22 18.4 21.6 18 21 18C20.4 18 20 18.4 20 19V20H19C18.4 20 18 20.4 18 21C18 21.6 18.4 22 19 22H21C21.6 22 22 21.6 22 21Z" fill="currentColor"/>
                                                                            <path d="M3 16C2.4 16 2 15.6 2 15V9C2 8.4 2.4 8 3 8C3.6 8 4 8.4 4 9V15C4 15.6 3.6 16 3 16ZM13 15V9C13 8.4 12.6 8 12 8C11.4 8 11 8.4 11 9V15C11 15.6 11.4 16 12 16C12.6 16 13 15.6 13 15ZM17 15V9C17 8.4 16.6 8 16 8C15.4 8 15 8.4 15 9V15C15 15.6 15.4 16 16 16C16.6 16 17 15.6 17 15ZM9 15V9C9 8.4 8.6 8 8 8H7C6.4 8 6 8.4 6 9V15C6 15.6 6.4 16 7 16H8C8.6 16 9 15.6 9 15ZM22 15V9C22 8.4 21.6 8 21 8H20C19.4 8 19 8.4 19 9V15C19 15.6 19.4 16 20 16H21C21.6 16 22 15.6 22 15Z" fill="currentColor"/>
                                                                            </svg>
                                                                        </span>
                                                                    </span>
                                                                </div>
                                                                <!--end::Symbol-->
                                                                <!--begin::Info-->
                                                                <div class="m-0">
                                                                    <span class="fw-semibold text-gray-400 d-block fs-8">Cant. contada</span>
                                                                    <a class="fw-bold text-gray-800 text-hover-primary fs-7">
                                                                        {{ingreso.cantidad.toFixed(2)}}
                                                                        <small>{{ingreso.unidad}}</small>
                                                                    </a>
                                                                </div>
                                                                <!--end::Info-->
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!--end::Body-->
                                            <div class="table-responsive" *ngIf="detalles.length >= 1">
                                                <!--begin::Table-->
                                                <table class="table table-row-bordered table-flush align-middle gy-6">
                                                    <!--begin::Thead-->
                                                    <thead class="border-bottom border-gray-200 fs-6 fw-bold bg-lighten">
                                                        <tr>
                                                            <th class="min-w-125px ps-9">Color</th>
                                                            <th class="min-w-250px text-end">CÃ³digo</th>
                                                            <th class="min-w-150px text-end pe-9">Cantidad</th>
                                                          
                                                        </tr>
                                                    </thead>
                                                    <!--end::Thead-->
                                                    <!--begin::Tbody-->
                                                    <tbody class="fs-6 fw-semibold" *ngFor="let item of resumen_ingreso;let idx = index">
                                                        <tr >
                                                            <td class="ps-9" style="padding-top: 1rem;
                                                            padding-bottom: 1rem;">
                                                                <div class="d-flex">
                                                                    <a class="symbol symbol-50px bg-secondary bg-opacity-25 rounded" >
                                                                        <span class="symbol-label" style="width: 35px;height: 35px;border: 1px dashed #ccc;" 
                                                                        [ngStyle]="{'background': item.hxd}"></span>
                                                                    </a>

                                                                    <div class="ms-5" >
                                                                        <!--begin::Title-->
                                                                        <a class="text-gray-800 fs-6 fw-bold text-1 fw-600 cursor-pointer texto-largo" style="font-size: 0.9rem!important;">
                                                                            <span placement="top" tooltipClass="bg_toolip" ngbTooltip="{{item.producto.titulo}}">
                                                                                {{item.producto}} - <i class="text-muted">{{item.variacion_name}}</i>
                                                                            </span>
                                                                            
                                                                        </a>
                                                                        <code>
                                                                            {{item.tipo}}
                                                                        </code>
                                                                    
                                                                    </div>
                                                                </div>
                                                            </td>
                                                            <td class="text-end">
                                                                <div class="text-gray-800 fs-7">Cantidad</div>
                                                                <div class="fs-7 fw-bold" data-kt-table-widget-4="template_qty">
                                                                    <i>
                                                                        {{item.cantidades.toFixed(2)}}
                                                                        <small *ngIf="item.tipo == 'Tela'">Mtr</small>
                                                                        <small *ngIf="item.tipo == 'Acero'">Kg</small>
                                                                        <small *ngIf="item.tipo == 'Ropa'">Unid</small>
                                                                    </i>
                                                                </div>
                                                            </td>
                                                            <td class="text-end pe-9">
                                                                <button (click)="setShow(idx)" class="btn btn-sm btn-icon btn-bg-light btn-active-color-primary w-30px h-30px">
                                                                    <i class="bi bi-plus-lg"></i>
                                                                </button>
                                                            </td>
                                                        </tr>
                                                        <tr *ngIf="item.show">
                                                            <td colspan="3" style="padding-top: 0px;">
                                                                <table class="w-100">
                                                                    <tr *ngFor="let subitem of item.detalles">
                                                                        <td class="ps-9" style="padding-top: 1rem;
                                                                        padding-bottom: 1rem;">
                                                                            <div class="d-flex">
                                                                                <a class="symbol symbol-50px bg-secondary bg-opacity-25 rounded" >
                                                                                    <span class="symbol-label" style="width: 35px;height: 35px;border: 1px dashed #ccc;" 
                                                                                    [ngStyle]="{'background': subitem.producto_variacion.hxd}"></span>
                                                                                </a>
                                                                    
                                                                                <div class="ms-5" style="max-width: 300px !important">
                                                                                    <!--begin::Title-->
                                                                                    <a class="text-gray-800 fs-6 fw-bold text-1 fw-600 cursor-pointer texto-largo" style="font-size: 0.8rem!important;">
                                                                                        <span placement="top" tooltipClass="bg_toolip" ngbTooltip="{{subitem.producto.titulo}}">
                                                                                            {{subitem.producto.titulo}}
                                                                                        </span>
                                                                                        
                                                                                    </a>
                                                                                    <code>
                                                                                        {{subitem.tipo}}
                                                                                    </code>
                                                                                    
                                                                                </div>
                                                                            </div>
                                                                        </td>
                                                                    
                                                                        <td class="text-end">
                                                                            <code>
                                                                                {{subitem.codigo.toUpperCase()}}
                                                                            </code>
                                                                        </td>
                                                                        
                                                                        <td class="text-end pe-9">
                                                                            {{subitem.cantidad.toFixed(2)}}
                                                                            <small>{{ingreso.unidad}}</small>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                       
                                                    </tbody>
                                                    <!--end::Tbody-->
                                                    <tfoot>
                                                        <td colspan="2"  class="ps-9">
                                                            <b>Total</b>
                                                        </td>
                                                        <td class="text-end pe-9">
                                                            <b style="padding-left: 0px;">
                                                                {{ingreso.cantidad.toFixed(2)}}
                                                                <small>{{ingreso.unidad}}</small>
                                                            </b>
                                                        </td> 
                                                        
                                                    </tfoot>
                                                </table>
                                                <!--end::Table-->
                                            </div>
                                        </div>
                                    </ng-container>
                                    <ng-container *ngIf="!data">
                                        <div class="card">
                                            <div class="card-body pt-15">
                                                <div class="text-center mt-20 mb-15">
                                                    <!--begin::Title-->
                                                    <img src="assets/icons/advertencia.gif" alt="" style="width: 80px;">
                                                    <h3 class="fs-2hx text-dark mb-5 mt-5">Parametro erroneo</h3>
                                                    <!--end::Title-->
                                                    <!--begin::Text-->
                                                    <div class="fs-5 text-muted fw-semibold">Verifique los parametros o datos enviados mediante la ruta.</div>
                                                    <!--end::Text-->
                                                </div>
                                            </div>
                                        </div>
                                    </ng-container>
                                </ng-container>

                                <ng-container *ngIf="load_data">
                                    <div class="py-20 text-center">
                                        <div class="spinner-border" style="width: 3rem; height: 3rem;" role="status">
                                            <span class="sr-only">Loading...</span>
                                        </div>
                                    </div>
                                </ng-container>
                            </div>
                        </div>
                       
                    </div>
                    <!--end::Container-->
                </div>
                <!--end::Post-->
            </div>
           
        </div>
        <!--end::Wrapper-->
    </div>
    <!--end::Page-->
</div>

